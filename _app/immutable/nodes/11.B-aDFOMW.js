import{s as _,e as w,c as y,b as A,f as m,i as L,G as M,I,D,o as K,k as q,n as C}from"../chunks/scheduler.ijEjBH80.js";import{S as E,i as T,c as x,a as k,m as H,t as d,b as h,e as S,d as P,g as V}from"../chunks/index.os67wVQB.js";import{b as G}from"../chunks/paths.hXSxtONK.js";import{p as R}from"../chunks/audio.DeAYY8kc.js";import{H as z,A as j,D as B}from"../chunks/common.consts.Cqy0S1Qp.js";import{s as F}from"../chunks/settings.B63KtCET.js";function J(s){let t,n,r;return n=new z({props:{text:s[1],words:s[0]}}),{c(){t=w("div"),x(n.$$.fragment)},l(e){t=y(e,"DIV",{});var o=A(t);k(n.$$.fragment,o),o.forEach(m)},m(e,o){L(e,t,o),H(n,t,null),s[4](t),r=!0},p(e,[o]){const i={};o&2&&(i.text=e[1]),o&1&&(i.words=e[0]),n.$set(i)},i(e){r||(d(n.$$.fragment,e),r=!0)},o(e){h(n.$$.fragment,e),r=!1},d(e){e&&m(t),S(n),s[4](null)}}}function N(s){if(s&&s instanceof HTMLElement){const t=s.getAttribute("data-placeholder")??"";Math.max(3,t.length)}}function p(s){s.target instanceof HTMLElement&&(s.target.querySelectorAll("br").forEach(t=>t.remove()),(s.target.querySelectorAll("br").length||s.target.innerText.trim()!==s.target.innerHTML.trim())&&(s.target.innerHTML=s.target.innerText))}function O(s,t,n){let{storageKey:r}=t,{words:e=[]}=t,{text:o}=t,i;M(()=>{i.querySelectorAll(".answer").forEach(a=>{if(a instanceof HTMLElement){const u=a.getAttribute("data-answer"),g=a.getAttribute("data-placeholder"),f=localStorage.getItem(`${r}_${u}`)||null;a.innerText=f??g??"",f&&typeof f=="string"?f!==u&&(a.classList.add("error"),a.setAttribute("contenteditable","true")):a.setAttribute("contenteditable","true"),N(a)}}),i.addEventListener("input",p),i.addEventListener("keypress",l)}),I(()=>{i.removeEventListener("input",p),i.removeEventListener("keypress",l)});function l(a){if(a.target instanceof HTMLElement){const u=a.target.innerText;if(a.target.querySelectorAll("br").forEach(g=>g.remove()),(a.target.querySelectorAll("br").length||u.trim()!==a.target.innerHTML.trim())&&(a.target.innerHTML=u),a.key==="Enter"){const g=a.target.getAttribute("data-answer"),f=u.trim().toLowerCase();f===g?(a.target.classList.remove("error"),a.target.removeAttribute("contenteditable"),R(`${G}/success.mp3`)):a.target.classList.add("error"),localStorage.setItem(`${r}_${g}`,f)}}}function c(a){D[a?"unshift":"push"](()=>{i=a,n(2,i)})}return s.$$set=a=>{"storageKey"in a&&n(3,r=a.storageKey),"words"in a&&n(0,e=a.words),"text"in a&&n(1,o=a.text)},[e,o,i,r,c]}class Q extends E{constructor(t){super(),T(this,t,O,J,_,{storageKey:3,words:0,text:1})}}function b(s){let t,n;return t=new Q({props:{storageKey:s[0].lesson+"_"+s[0].exercise.position,text:s[2],words:s[1]}}),{c(){x(t.$$.fragment)},l(r){k(t.$$.fragment,r)},m(r,e){H(t,r,e),n=!0},p(r,e){const o={};e&1&&(o.storageKey=r[0].lesson+"_"+r[0].exercise.position),e&4&&(o.text=r[2]),e&2&&(o.words=r[1]),t.$set(o)},i(r){n||(d(t.$$.fragment,r),n=!0)},o(r){h(t.$$.fragment,r),n=!1},d(r){S(t,r)}}}function U(s){let t,n=s[2],r,e=b(s);return{c(){t=w("div"),e.c(),this.h()},l(o){t=y(o,"DIV",{class:!0});var i=A(t);e.l(i),i.forEach(m),this.h()},h(){K(t,"class","md")},m(o,i){L(o,t,i),e.m(t,null),r=!0},p(o,[i]){i&4&&_(n,n=o[2])?(V(),h(e,1,1,C),P(),e=b(o),e.c(),d(e,1),e.m(t,null)):e.p(o,i)},i(o){r||(d(e),r=!0)},o(o){h(e),r=!1},d(o){o&&m(t),e.d(o)}}}function W(s,t,n){let r;q(s,F,c=>n(4,r=c));let{data:e}=t,o=[],i="",l=[];return s.$$set=c=>{"data"in c&&n(0,e=c.data)},s.$$.update=()=>{s.$$.dirty&1&&(n(3,o=e.dict.map(c=>({word:c.origin.trim().replace(/(\sη$)|(\sο$)|(\sτο$)/,""),title:c.translate,whole:!0}))),n(2,i=e.exercise.text??"")),s.$$.dirty&26&&(n(1,l=[]),r.showTranslates&&l.push(["color: steelblue;",o]),r.showArticles&&l.push(["color: coral;",j]),r.showDigraphs&&l.push(["text-decoration: underline;",B]),n(1,l),n(4,r),n(3,o),n(0,e))},[e,l,i,o,r]}class te extends E{constructor(t){super(),T(this,t,W,U,_,{data:0})}}export{te as component};
